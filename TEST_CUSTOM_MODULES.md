# 自定义模块功能测试清单

## 测试环境准备

1. ✅ 启动开发服务器
2. ✅ 登录管理后台 `/admin`
3. ✅ 进入系统设置 `/admin/settings`
4. ✅ 切换到"主题设置"标签
5. ✅ 激活"杂志主题"
6. ✅ 启用"显示侧边栏"选项

## 功能测试

### 1. 添加模块测试

- [ ] 点击"+ 添加自定义模块"按钮
- [ ] 填写模块标题："测试模块"
- [ ] 填写 HTML 代码：`<p class="text-sm">这是测试内容</p>`
- [ ] 勾选"启用此模块"
- [ ] 点击"添加"按钮
- [ ] 验证：模块出现在列表中

### 2. 编辑模块测试

- [ ] 点击已添加模块的"编辑"按钮
- [ ] 修改标题为："测试模块（已编辑）"
- [ ] 修改 HTML 内容
- [ ] 点击"更新"按钮
- [ ] 验证：模块内容已更新

### 3. 排序测试

- [ ] 添加至少 2 个模块
- [ ] 点击第二个模块的 ▲ 按钮
- [ ] 验证：模块顺序交换
- [ ] 点击第一个模块的 ▼ 按钮
- [ ] 验证：模块顺序恢复

### 4. 启用/禁用测试

- [ ] 点击模块的开关按钮禁用
- [ ] 验证：开关变为灰色
- [ ] 前往博客首页查看
- [ ] 验证：该模块不显示在侧边栏
- [ ] 返回后台重新启用
- [ ] 验证：模块重新显示

### 5. 删除模块测试

- [ ] 点击模块的"删除"按钮
- [ ] 验证：模块从列表中移除
- [ ] 前往博客首页查看
- [ ] 验证：模块不再显示

### 6. JavaScript 执行测试

添加带 JS 的模块：

**标题**：`JS 测试`

**HTML**：
```html
<div id="js-test-output" class="text-sm text-gray-600">等待加载...</div>
```

**JS**：
```javascript
setTimeout(() => {
  const el = document.getElementById('js-test-output');
  if (el) {
    el.textContent = 'JS 执行成功！';
    el.className = 'text-sm text-green-600 font-bold';
  }
}, 1000);
```

- [ ] 添加上述模块
- [ ] 前往博客首页
- [ ] 验证：1秒后文字变为"JS 执行成功！"且变绿

### 7. 样式测试

添加带样式的模块：

**标题**：`样式测试`

**HTML**：
```html
<div class="space-y-2">
  <div class="p-3 bg-violet-50 dark:bg-violet-900/20 rounded-lg">
    <p class="text-sm text-violet-600 dark:text-violet-400">紫色卡片</p>
  </div>
  <div class="p-3 bg-gradient-to-r from-violet-500 to-fuchsia-500 rounded-lg">
    <p class="text-sm text-white font-bold">渐变卡片</p>
  </div>
</div>
```

- [ ] 添加上述模块
- [ ] 前往博客首页
- [ ] 验证：样式正确显示
- [ ] 切换暗色模式
- [ ] 验证：暗色模式样式正确

### 8. 前台显示测试

- [ ] 前往博客首页 `/`
- [ ] 验证：侧边栏显示在右侧
- [ ] 验证：自定义模块显示在"快捷导航"下方
- [ ] 验证：模块按照设置的顺序显示
- [ ] 验证：只显示已启用的模块

### 9. 响应式测试

- [ ] 在桌面浏览器查看（宽度 > 1024px）
- [ ] 验证：侧边栏显示在右侧
- [ ] 调整浏览器宽度到平板尺寸（768px - 1024px）
- [ ] 验证：侧边栏显示在内容下方
- [ ] 调整浏览器宽度到手机尺寸（< 768px）
- [ ] 验证：侧边栏显示在内容下方，宽度自适应

### 10. 数据持久化测试

- [ ] 添加多个自定义模块
- [ ] 刷新管理后台页面
- [ ] 验证：模块配置保持不变
- [ ] 刷新博客首页
- [ ] 验证：模块正常显示
- [ ] 重启服务器
- [ ] 验证：模块配置依然存在

## 边界情况测试

### 空数据测试
- [ ] 不添加任何模块
- [ ] 验证：侧边栏正常显示其他内容
- [ ] 验证：没有错误提示

### 特殊字符测试
- [ ] 在标题中输入特殊字符：`<script>alert('test')</script>`
- [ ] 验证：特殊字符被正确转义
- [ ] 在 HTML 中输入：`<img src=x onerror="alert('xss')">`
- [ ] 验证：代码按预期执行（因为是管理员操作）

### 大量数据测试
- [ ] 添加 10 个以上的模块
- [ ] 验证：列表正常显示
- [ ] 验证：滚动流畅
- [ ] 验证：前台加载正常

### 长文本测试
- [ ] 添加包含大量文本的 HTML（1000+ 字符）
- [ ] 验证：保存成功
- [ ] 验证：前台显示正常

## 性能测试

- [ ] 添加 5 个模块，每个包含复杂的 HTML 和 JS
- [ ] 使用浏览器开发者工具测量页面加载时间
- [ ] 验证：页面加载时间在可接受范围内（< 3秒）
- [ ] 验证：没有内存泄漏

## 兼容性测试

### 浏览器兼容性
- [ ] Chrome/Edge（最新版）
- [ ] Firefox（最新版）
- [ ] Safari（最新版）
- [ ] 移动端浏览器

### 主题兼容性
- [ ] 切换到其他主题（Classic、Minimal）
- [ ] 验证：自定义模块配置不影响其他主题
- [ ] 切换回杂志主题
- [ ] 验证：模块正常显示

## 错误处理测试

### 无效 JSON 测试
- [ ] 手动修改数据库中的 customModules 为无效 JSON
- [ ] 验证：前台不崩溃，显示空列表

### 缺失字段测试
- [ ] 创建缺少 title 的模块
- [ ] 验证：显示错误提示或使用默认值

### JS 错误测试
- [ ] 添加包含语法错误的 JS 代码
- [ ] 验证：控制台显示错误但不影响页面其他功能

## 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 添加模块 | ⬜ |  |
| 编辑模块 | ⬜ |  |
| 排序功能 | ⬜ |  |
| 启用/禁用 | ⬜ |  |
| 删除模块 | ⬜ |  |
| JS 执行 | ⬜ |  |
| 样式显示 | ⬜ |  |
| 前台显示 | ⬜ |  |
| 响应式 | ⬜ |  |
| 数据持久化 | ⬜ |  |

## 已知问题

（测试过程中发现的问题记录在这里）

## 改进建议

（测试过程中的改进建议记录在这里）
